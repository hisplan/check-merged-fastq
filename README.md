# check-merged-fastq

Check whether a merged FASTQ file generated by SEQC is correct or not.

## Set Up

```
conda create -n check python=3.8 pip
conda activate check
pip install -r requirements.txt
```

## How to Run

Download barcode/genomic FASTQ files and merged FASTQ file from AWS S3:

```bash
$ cd workspace
$ ./download.sh
USAGE: download.sh [options]
    -s  S3 URI (e.g. s3://dp-lab-data/collaborators/aboire/ImmunologicalDeterminantsLeptomeningealMet/blood2_CX3CR1_CCR2)
    -d  destination (e.g. blood2_CX3CR1_CCR2)

$ ./download.sh \
  -s s3://dp-lab-data/collaborators/aboire/ImmunologicalDeterminantsLeptomeningealMet/blood2_CX3CR1_CCR2 \
  -d blood2_CX3CR1_CCR2
```

Split the merged FASTQ files into multiple chunks in order to speed up the checking process:

```bash
$ cd ..
$ ./split.sh
USAGE: split.sh [options]
    -w  working directory (e.g. workspace/blood2_CX3CR1_CCR2)
    -m  merged FASTQ filename only, not the whole path (e.g. 2653_blood2_CX3CR1_CCR2_IGO_12104_39_merged.fastq.gz)
    -n  number of chunks to generate (default=20)

$ ./split.sh
  -w workspace/blood2_CX3CR1_CCR2 \
  -m 2653_blood2_CX3CR1_CCR2_IGO_12104_39_merged.fastq.gz
```

Run the checking process:

```bash
$ python check_validity.py \
    --sample=2653_blood2_CX3CR1_CCR2_IGO_12104_39_S13 \
    --barcode=/fscratch/chunj/seqc-sort/barcode \
    --genomic=/fscratch/chunj/seqc-sort/genomic \
    --kit=v3 \
    --threads=20
```
